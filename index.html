<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sovereign BTC Pilot</title>
    <script src="https://cdn.ethers.io/lib/ethers-5.2.umd.min.js"></script>
    <style>
        body { background: #000; color: #00ff41; font-family: 'Courier New', monospace; padding: 20px; text-align: center; }
        .price { font-size: 2.5rem; margin: 10px 0; color: #fff; }
        button { background: transparent; color: #00ff41; border: 2px solid #00ff41; padding: 20px; width: 100%; font-weight: bold; border-radius: 8px; cursor: pointer; text-transform: uppercase; }
        #log { font-size: 0.75rem; text-align: left; margin-top: 20px; color: #888; background: #0a0a0a; padding: 15px; height: 180px; overflow-y: auto; border: 1px solid #222; }
        .success { color: #fff; box-shadow: 0 0 5px #00ff41; }
    </style>
</head>
<body>
    <div style="font-size: 0.7rem; letter-spacing: 2px;">[ PILOT STAGE: HANDSHAKE ]</div>
    <div class="price" id="price">...</div>
    
    <button id="connectBtn">AUTHORIZE PILOT</button>
    
    <div id="log">> READY FOR HANDSHAKE...</div>

    <script>
        const log = (msg) => {
            const l = document.getElementById('log');
            l.innerHTML += `<br>> ${msg}`;
            l.scrollTop = l.scrollHeight;
        };

        async function authorize() {
            log("Handshake initiated...");
            
            // The 2026 Direct Injection hunt
            const provider = window.trustwallet?.ethereum || window.ethereum;

            if (!provider) {
                log("<span style='color:red;'>FAILURE: WALLET NOT INJECTED.</span>");
                return;
            }

            try {
                // FORCE RESET: Some wallets hang on previous requests
                log("Clearing stale requests...");
                
                // The actual handshake
                const accounts = await provider.request({ method: 'eth_requestAccounts' });
                
                if (accounts.length > 0) {
                    const walletAddr = accounts[0];
                    log(`<span class="success">ACCESS GRANTED: ${walletAddr.slice(0,10)}...</span>`);
                    document.getElementById('connectBtn').innerText = "PILOT ARMED";
                    document.getElementById('connectBtn').disabled = true;
                    
                    // INITIALIZE THE $30 REASONING ENGINE
                    startEngine(walletAddr);
                }
            } catch (err) {
                if (err.code === 4001) {
                    log("<span style='color:orange;'>REJECTED: Architect cancelled request.</span>");
                } else {
                    log("SYSTEM ERR: " + err.message);
                }
            }
        }

        async function getPrice() {
            const res = await fetch('https://api.binance.com/api/v3/ticker/price?symbol=BTCUSDT');
            const data = await res.json();
            document.getElementById('price').innerText = `$${parseFloat(data.price).toLocaleString()}`;
        }

        function startEngine(addr) {
            log("Analyzing $30 Vault Balance...");
            log("Strategy: Real-time Autonomous Scaling.");
            // Next: We add the 'Buy' button logic for the $30
        }

        document.getElementById('connectBtn').onclick = authorize;
        setInterval(getPrice, 5000);
        getPrice();
    </script>
</body>
</html>
